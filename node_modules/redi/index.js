var isRegExp = require('util').isRegExp;

var routes = [];

module.exports = function (req, res) {
  if (typeof req === 'string') req = new RegExp(req);

  if (isRegExp(req)) return routes.push([req, res]);

  for (var i = 0; i < routes.length; i++) {
    var re = routes[i][0];
    var cb = routes[i][1];
    var match = re.exec(req.url);

    if (match) return cb.apply(null, [req, res].concat(match.slice(1)));
  }

  res.statusCode = 404;
  res.end();
};
